// Generated by ReScript, PLEASE EDIT WITH CARE

import * as React from "react";
import * as Recoil from "recoil";
import * as APIUtils from "../APIUtils/APIUtils.bs.js";
import * as PageUtils from "../Helpers/PageUtils.bs.js";
import * as LogicUtils from "../../utils/LogicUtils.bs.js";
import * as TableAtoms from "../../Recoils/TableAtoms.bs.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as LoadedTable from "../../components/LoadedTable.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as OrderUIUtils from "../Order/OrderUIUtils.bs.js";
import * as PayoutsUtils from "./PayoutsUtils.bs.js";
import * as ErrorBoundary from "../../components/ErrorBoundary.bs.js";
import * as PayoutsEntity from "./PayoutsEntity.bs.js";
import * as PortalCapture from "../../components/portal/PortalCapture.bs.js";
import * as PageLoaderWrapper from "../Helpers/PageLoaderWrapper.bs.js";
import * as HSwitchRemoteFilter from "../HSwitchRemoteFilter.bs.js";
import * as JsxPPXReactSupportU from "rescript/lib/es6/jsxPPXReactSupportU.js";
import * as LoadedTableWithCustomColumns from "../../components/LoadedTableWithCustomColumns.bs.js";

function PayoutsList(props) {
  var getURL = APIUtils.useGetURL();
  var updateDetails = APIUtils.useUpdateMethod(undefined, undefined);
  var match = React.useState(function () {
    return "Loading";
  });
  var setScreenState = match[1];
  var match$1 = React.useState(function () {
    return [];
  });
  var setPayoutsData = match$1[1];
  var payoutData = match$1[0];
  var match$2 = React.useState(function () {
    return 0;
  });
  var setTotalCount = match$2[1];
  var match$3 = React.useState(function () {
    return "";
  });
  var searchText = match$3[0];
  var match$4 = React.useState(function () {});
  var filters = match$4[0];
  var pageDetailDict = Recoil.useRecoilValue(LoadedTable.table_pageDetails);
  var pageDetail = Core__Option.getOr(pageDetailDict["Payouts"], {
    offset: 0,
    resultsPerPage: 10,
  });
  var match$5 = React.useState(function () {
    return pageDetail.offset;
  });
  var setOffset = match$5[1];
  var offset = match$5[0];
  var fetchPayouts = function () {
    if (filters === undefined) {
      return;
    }
    var filters$1 = Object.fromEntries([["offset", offset]]);
    if (!LogicUtils.isEmptyString(searchText)) {
      filters$1["payout_id"] = searchText.trim();
    }
    Object.entries(filters).forEach(function (item) {
      filters$1[item[0]] = item[1];
    });
    PayoutsUtils.getPayoutsList(
      filters$1,
      updateDetails,
      setPayoutsData,
      setScreenState,
      offset,
      setTotalCount,
      setOffset,
      getURL,
    );
  };
  React.useEffect(
    function () {
      if (OrderUIUtils.isNonEmptyValue(filters)) {
        fetchPayouts();
      }
    },
    [offset, filters, searchText],
  );
  var filterUrl = getURL(
    "PAYOUTS",
    "Get",
    "filter",
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
    undefined,
  );
  return React.createElement(ErrorBoundary.make, {
    children: React.createElement(
      "div",
      {
        className: "min-h-[50vh]",
      },
      React.createElement(PageUtils.PageHeading.make, {
        title: "Payouts",
        subTitle: "View and manage all payouts",
      }),
      React.createElement(
        "div",
        {
          className: "flex justify-between gap-3",
        },
        React.createElement(
          "div",
          {
            className: "flex-1",
          },
          React.createElement(HSwitchRemoteFilter.RemoteTableFilters.make, {
            apiType: "Post",
            filterUrl: filterUrl,
            setFilters: match$4[1],
            endTimeFilterKey: PayoutsUtils.endTimeFilterKey,
            startTimeFilterKey: PayoutsUtils.startTimeFilterKey,
            initialFilters: PayoutsUtils.initialFilters,
            initialFixedFilter: PayoutsUtils.initialFixedFilter,
            setOffset: setOffset,
            customLeftView: React.createElement(
              HSwitchRemoteFilter.SearchBarFilter.make,
              {
                placeholder: "Search payout id",
                setSearchVal: match$3[1],
                searchVal: searchText,
              },
            ),
          }),
        ),
        JsxPPXReactSupportU.createElementWithKey(
          "PayoutsCustomizeColumn",
          PortalCapture.make,
          {
            name: "PayoutsCustomizeColumn",
          },
        ),
      ),
      React.createElement(PageLoaderWrapper.make, {
        children: Caml_option.some(
          React.createElement(LoadedTableWithCustomColumns.make, {
            title: "Payouts",
            showSerialNumber: true,
            actualData: payoutData,
            totalResults: match$2[0],
            resultsPerPage: 10,
            offset: offset,
            setOffset: setOffset,
            entity: PayoutsEntity.payoutEntity,
            currrentFetchCount: payoutData.length,
            hideTitle: true,
            customColumnMapper: TableAtoms.payoutsMapDefaultCols,
            defaultColumns: PayoutsEntity.defaultColumns,
            sortingBasedOnDisabled: false,
            showSerialNumberInCustomizeColumns: false,
            showResultsPerPageSelector: false,
          }),
        ),
        screenState: match[0],
        customUI: Caml_option.some(PayoutsUtils.customUI),
      }),
    ),
  });
}

var make = PayoutsList;

export { make };
/* react Not a pure module */
