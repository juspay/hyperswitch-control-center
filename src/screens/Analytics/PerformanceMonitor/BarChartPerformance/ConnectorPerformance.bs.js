// Generated by ReScript, PLEASE EDIT WITH CARE

import * as React from "react";
import * as APIUtils from "../../../APIUtils/APIUtils.bs.js";
import * as LogicUtils from "../../../../utils/LogicUtils.bs.js";
import * as Caml_option from "rescript/lib/es6/caml_option.js";
import * as HighchartBarChart from "../../../../components/CustomCharts/HighchartBarChart.bs.js";
import * as PaymentAnalyticsEntity from "../../PaymentsAnalytics/PaymentAnalyticsEntity.bs.js";
import * as PerformanceMonitorEntity from "../PerformanceMonitorEntity.bs.js";
import * as ConnectorPerformanceUtils from "./ConnectorPerformanceUtils.bs.js";

function ConnectorPerformance(props) {
  var dimensions = props.dimensions;
  var endTimeVal = props.endTimeVal;
  var startTimeVal = props.startTimeVal;
  var updateDetails = APIUtils.useUpdateMethod(undefined, undefined);
  var match = React.useState(function () {
    return [[], []];
  });
  var setBarSeries = match[1];
  var barSeries = match[0];
  var barOption = React.useMemo(
    function () {
      return PerformanceMonitorEntity.barOption(barSeries[0], barSeries[1]);
    },
    [barSeries],
  );
  var chartFetch = async function () {
    try {
      var body = PerformanceMonitorEntity.getPerformanceMonitorBody(
        "ConnectorPerformance",
        dimensions,
        startTimeVal,
        endTimeVal,
      );
      var res = await updateDetails(
        "https://sandbox.hyperswitch.io/analytics/v1/metrics/payments",
        body,
        "Post",
        undefined,
        undefined,
        undefined,
        undefined,
      );
      var mappedResponse =
        PaymentAnalyticsEntity.paymentDistributionObjMapper(res);
      var d = ConnectorPerformanceUtils.getBarOptions(mappedResponse);
      return setBarSeries(function (param) {
        return d;
      });
    } catch (exn) {
      return;
    }
  };
  React.useEffect(
    function () {
      if (
        LogicUtils.isNonEmptyString(startTimeVal) &&
        LogicUtils.isNonEmptyString(endTimeVal)
      ) {
        chartFetch();
      }
    },
    [startTimeVal, endTimeVal],
  );
  return React.createElement(React.Fragment, {
    children: Caml_option.some(
      React.createElement(HighchartBarChart.RawBarChart.make, {
        options: barOption,
      }),
    ),
  });
}

var make = ConnectorPerformance;

export { make };
/* react Not a pure module */
