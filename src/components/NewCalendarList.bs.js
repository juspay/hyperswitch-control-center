// Generated by ReScript, PLEASE EDIT WITH CARE

import * as DayJs from "../libraries/DayJs.bs.js";
import Dayjs from "dayjs";
import * as React from "react";
import * as Caml_obj from "rescript/lib/es6/caml_obj.js";
import * as TextInput from "./form/TextInput.bs.js";
import * as LogicUtils from "../utils/LogicUtils.bs.js";
import * as Core__Array from "@rescript/core/src/Core__Array.bs.js";
import * as NewCalendar from "./NewCalendar.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";
import * as DateTimeUtils from "../utils/DateTimeUtils.bs.js";
import * as JsxPPXReactSupportU from "rescript/lib/es6/jsxPPXReactSupportU.js";

function NewCalendarList(props) {
  var __customDisabledFutureDays = props.customDisabledFutureDays;
  var setShowMsg = props.setShowMsg;
  var dateRangeLimit = props.dateRangeLimit;
  var __disableFutureDates = props.disableFutureDates;
  var __disablePastDates = props.disablePastDates;
  var __showTime = props.showTime;
  var __endDate = props.endDate;
  var __startDate = props.startDate;
  var cellRenderer = props.cellRenderer;
  var cellHighlighter = props.cellHighlighter;
  var __count = props.count;
  var changeStartDate = props.changeStartDate;
  var changeEndDate = props.changeEndDate;
  var onDateClick = props.onDateClick;
  var year = props.year;
  var month = props.month;
  var __calendarContaierStyle = props.calendarContaierStyle;
  var __changeHighlightCellStyle = props.changeHighlightCellStyle;
  var changeHighlightCellStyle =
    __changeHighlightCellStyle !== undefined ? __changeHighlightCellStyle : "";
  var calendarContaierStyle =
    __calendarContaierStyle !== undefined ? __calendarContaierStyle : "";
  var count = __count !== undefined ? __count : 1;
  var startDate = __startDate !== undefined ? __startDate : "";
  var endDate = __endDate !== undefined ? __endDate : "";
  var showTime = __showTime !== undefined ? __showTime : false;
  var disablePastDates =
    __disablePastDates !== undefined ? __disablePastDates : true;
  var disableFutureDates =
    __disableFutureDates !== undefined ? __disableFutureDates : false;
  var customDisabledFutureDays =
    __customDisabledFutureDays !== undefined ? __customDisabledFutureDays : 0.0;
  var match = React.useState(function () {
    return "";
  });
  var setFromDate = match[1];
  var fromDate = match[0];
  var match$1 = React.useState(function () {
    return "";
  });
  var setToDate = match$1[1];
  var toDate = match$1[0];
  var match$2 = React.useState(function () {
    return false;
  });
  var setFromDateOnFocus = match$2[1];
  var fromDateOnFocus = match$2[0];
  var match$3 = React.useState(function () {
    return false;
  });
  var setToDateOnFocus = match$3[1];
  var toDateOnFocus = match$3[0];
  var match$4 = React.useState(function () {
    return false;
  });
  var setIsDateClicked = match$4[1];
  var isDateClicked = match$4[0];
  var startYear = year !== undefined ? year : new Date().getFullYear();
  React.useEffect(
    function () {
      var fromDateJs = Dayjs(fromDate);
      var toDateJs = Dayjs(toDate);
      var permittedMaxYears = ((startYear | 0) + 10) | 0;
      var updatedFromDate;
      if (
        LogicUtils.isNonEmptyString(fromDate) &&
        fromDate.length >= 5 &&
        fromDateJs.isValid() &&
        fromDateJs.year() <= permittedMaxYears
      ) {
        try {
          updatedFromDate = fromDateJs.format("YYYY-MM-DD");
        } catch (_error) {
          updatedFromDate = "";
        }
      } else {
        updatedFromDate = "";
      }
      var updatedToDate;
      if (
        LogicUtils.isNonEmptyString(toDate) &&
        toDate.length >= 5 &&
        toDateJs.isValid() &&
        toDateJs.year() <= permittedMaxYears
      ) {
        try {
          updatedToDate = toDateJs.format("YYYY-MM-DD");
        } catch (_error$1) {
          updatedToDate = "";
        }
      } else {
        updatedToDate = "";
      }
      if (
        LogicUtils.isNonEmptyString(updatedFromDate) &&
        updatedFromDate !== startDate &&
        changeStartDate !== undefined
      ) {
        changeStartDate(updatedFromDate, false, false, undefined);
      }
      if (
        LogicUtils.isNonEmptyString(updatedFromDate) &&
        LogicUtils.isNonEmptyString(updatedToDate) &&
        updatedToDate !== endDate &&
        Caml_obj.greaterequal(toDateJs, fromDateJs) &&
        changeEndDate !== undefined
      ) {
        changeEndDate(updatedToDate, false, undefined);
      }
    },
    [fromDate, toDate],
  );
  React.useEffect(
    function () {
      if (LogicUtils.isNonEmptyString(startDate) && !fromDateOnFocus) {
        setFromDate(function (param) {
          return Dayjs(startDate).format("MMM DD, YYYY");
        });
      }
      if (LogicUtils.isNonEmptyString(endDate) && !toDateOnFocus) {
        setToDate(function (param) {
          return Dayjs(endDate).format("MMM DD, YYYY");
        });
      } else {
        setToDate(function (param) {
          return "";
        });
      }
    },
    [fromDateOnFocus, toDateOnFocus],
  );
  React.useEffect(
    function () {
      if (isDateClicked) {
        if (LogicUtils.isNonEmptyString(startDate) && !fromDateOnFocus) {
          setFromDate(function (param) {
            return Dayjs(startDate).format("MMM DD, YYYY");
          });
        }
        if (LogicUtils.isNonEmptyString(endDate) && !toDateOnFocus) {
          setToDate(function (param) {
            return Dayjs(endDate).format("MMM DD, YYYY");
          });
        } else {
          setToDate(function (param) {
            return "";
          });
        }
        setIsDateClicked(function (param) {
          return false;
        });
      }
    },
    [isDateClicked],
  );
  var match$5 = React.useState(function () {
    return "";
  });
  var setHoverdDate = match$5[1];
  var hoverdDate = match$5[0];
  var getMonthFromFloat = function (value) {
    var valueInt = value | 0;
    return Core__Option.getOr(DateTimeUtils.months[valueInt], "Jan");
  };
  var startMonth;
  if (month !== undefined) {
    startMonth = DateTimeUtils.months.indexOf(month) | 0;
  } else {
    var tMonth = new Date().getMonth() | 0;
    startMonth = disableFutureDates && count > 1 ? tMonth - 1.0 : tMonth;
  }
  var match$6 = React.useState(function () {
    return new Date(startYear, startMonth);
  });
  var currDateIm = match$6[0];
  var dummyRow = Core__Array.make(count, 1);
  return React.createElement(
    "div",
    {
      className:
        "flex flex-1 flex-row justify-center overflow-auto select-none " +
        calendarContaierStyle,
    },
    dummyRow.map(function (_item, i) {
      var currDateTemp = new Date(currDateIm.valueOf());
      var tempDate = currDateTemp.setMonth(
        ((currDateTemp.getMonth() | 0) + i) | 0,
      );
      var tempMonth = disableFutureDates
        ? new Date(
            DayJs.getDayJsForJsDate(new Date(tempDate)).toString(),
          ).getMonth()
        : new Date(tempDate).getMonth();
      var tempYear = new Date(tempDate).getFullYear();
      var inputFromDate_onBlur = function (param) {
        setFromDateOnFocus(function (param) {
          return false;
        });
      };
      var inputFromDate_onChange = function (ev) {
        var value = ev.target.value;
        setFromDate(function (param) {
          return value;
        });
      };
      var inputFromDate_onFocus = function (param) {
        setFromDateOnFocus(function (param) {
          return true;
        });
      };
      var inputFromDate = {
        name: "fromDate",
        onBlur: inputFromDate_onBlur,
        onChange: inputFromDate_onChange,
        onFocus: inputFromDate_onFocus,
        value: fromDate,
        checked: true,
      };
      var inputtoDate_onBlur = function (param) {
        setToDateOnFocus(function (param) {
          return false;
        });
      };
      var inputtoDate_onChange = function (ev) {
        var value = ev.target.value;
        setToDate(function (param) {
          return value;
        });
      };
      var inputtoDate_onFocus = function (param) {
        setToDateOnFocus(function (param) {
          return true;
        });
      };
      var inputtoDate = {
        name: "toDate",
        onBlur: inputtoDate_onBlur,
        onChange: inputtoDate_onChange,
        onFocus: inputtoDate_onFocus,
        value: toDate,
        checked: true,
      };
      var topPadding = showTime ? "" : "pt-6";
      return React.createElement(
        "div",
        {
          key: i.toString(),
        },
        React.createElement(
          "div",
          {
            className:
              "flex flex-row justify-between items-center px-6 pb-5 " +
              topPadding,
          },
          React.createElement(TextInput.make, {
            input: inputFromDate,
            placeholder: "From",
            customDashboardClass: "h-11 text-base font-normal shadow-jp-2-xs",
            customStyle: "!text-[#344054] font-inter-style",
          }),
          React.createElement(
            "div",
            {
              className:
                "font-normal text-base text-jp-gray-800 dark:text-jp-gray-text_darktheme dark:text-opacity-75 px-4",
            },
            "-",
          ),
          React.createElement(TextInput.make, {
            input: inputtoDate,
            placeholder: "To",
            customDashboardClass: "h-11 text-base font-normal shadow-jp-2-xs",
            customStyle: "!text-[#344054] font-inter-style",
          }),
        ),
        JsxPPXReactSupportU.createElementWithKey(
          i.toString(),
          NewCalendar.make,
          {
            changeHighlightCellStyle: changeHighlightCellStyle,
            month: getMonthFromFloat(tempMonth),
            year: tempYear | 0,
            onDateClick: onDateClick,
            hoverdDate: hoverdDate,
            setHoverdDate: setHoverdDate,
            showTitle: false,
            cellHighlighter: cellHighlighter,
            cellRenderer: cellRenderer,
            startDate: startDate,
            endDate: endDate,
            disablePastDates: disablePastDates,
            disableFutureDates: disableFutureDates,
            dateRangeLimit: dateRangeLimit,
            setShowMsg: setShowMsg,
            customDisabledFutureDays: customDisabledFutureDays,
            setIsDateClicked: setIsDateClicked,
          },
        ),
      );
    }),
  );
}

var make = NewCalendarList;

export { make };
/* DayJs Not a pure module */
