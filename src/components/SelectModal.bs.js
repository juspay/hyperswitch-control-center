// Generated by ReScript, PLEASE EDIT WITH CARE

import * as Modal from "../utils/Modal.bs.js";
import * as React from "react";
import * as Button from "./Button.bs.js";
import * as SelectBox from "./SelectBox.bs.js";
import * as LogicUtils from "../utils/LogicUtils.bs.js";
import * as Core__Option from "@rescript/core/src/Core__Option.bs.js";

function SelectModal(props) {
  var __headerClass = props.headerClass;
  var __headerTextClass = props.headerTextClass;
  var __showConversionRate = props.showConversionRate;
  var __showSerialNumber = props.showSerialNumber;
  var __sortingBasedOnDisabled = props.sortingBasedOnDisabled;
  var __enableSelect = props.enableSelect;
  var __maxSelection = props.maxSelection;
  var __showSelectAll = props.showSelectAll;
  var __showDeSelectAll = props.showDeSelectAll;
  var __disableSelect = props.disableSelect;
  var __title = props.title;
  var __closeOnOutsideClick = props.closeOnOutsideClick;
  var __revealFrom = props.revealFrom;
  var options = props.options;
  var initialValues = props.initialValues;
  var onSubmit = props.onSubmit;
  var __isModalView = props.isModalView;
  var showModal = props.showModal;
  var __modalHeadingDescription = props.modalHeadingDescription;
  var __modalHeading = props.modalHeading;
  var modalHeading =
    __modalHeading !== undefined ? __modalHeading : "Select Options";
  var modalHeadingDescription =
    __modalHeadingDescription !== undefined ? __modalHeadingDescription : "";
  var isModalView = __isModalView !== undefined ? __isModalView : true;
  var revealFrom = __revealFrom !== undefined ? __revealFrom : "Right";
  var closeOnOutsideClick =
    __closeOnOutsideClick !== undefined ? __closeOnOutsideClick : true;
  var title = __title !== undefined ? __title : "Columns";
  var disableSelect = __disableSelect !== undefined ? __disableSelect : false;
  var showDeSelectAll =
    __showDeSelectAll !== undefined ? __showDeSelectAll : false;
  var showSelectAll = __showSelectAll !== undefined ? __showSelectAll : true;
  var maxSelection = __maxSelection !== undefined ? __maxSelection : -1;
  var enableSelect = __enableSelect !== undefined ? __enableSelect : false;
  var sortingBasedOnDisabled =
    __sortingBasedOnDisabled !== undefined ? __sortingBasedOnDisabled : true;
  var showSerialNumber =
    __showSerialNumber !== undefined ? __showSerialNumber : true;
  var showConversionRate =
    __showConversionRate !== undefined ? __showConversionRate : false;
  var headerTextClass =
    __headerTextClass !== undefined
      ? __headerTextClass
      : "text-3xl font-semibold tracking-tight";
  var headerClass = __headerClass !== undefined ? __headerClass : "";
  var maxLengthArray = function (arr, setValues) {
    if (maxSelection === -1) {
      return setValues(function (param) {
        return arr;
      });
    }
    if (arr.length <= maxSelection) {
      return setValues(function (param) {
        return arr;
      });
    }
    var temp = arr.slice((arr.length - maxSelection) | 0);
    return setValues(function (param) {
      return temp;
    });
  };
  var match = React.useState(function () {
    return initialValues;
  });
  var setValues = match[1];
  var values = match[0];
  var onClick = function (param) {
    onSubmit(values);
  };
  var disableSelectBtn = React.useMemo(
    function () {
      if (initialValues.toString() === values.toString() && !enableSelect) {
        return true;
      } else {
        return values.length === 0;
      }
    },
    [values, initialValues],
  );
  var len = values.length;
  var buttonText = Core__Option.getOr(
    props.submitButtonText,
    len > 0 ? len.toString() + " " + title + " Selected" : "Select",
  );
  React.useEffect(
    function () {
      if (!showModal) {
        setValues(function (param) {
          return initialValues;
        });
      }
    },
    [showModal, initialValues],
  );
  var applyBtnStyle = "w-full mx-5";
  var input_onBlur = function (_ev) {};
  var input_onChange = function (ev) {
    maxLengthArray(ev, setValues);
  };
  var input_onFocus = function (_ev) {};
  var input_value = LogicUtils.getJsonFromArrayOfString(values);
  var input = {
    name: "cutomixedColumnsInput",
    onBlur: input_onBlur,
    onChange: input_onChange,
    onFocus: input_onFocus,
    value: input_value,
    checked: false,
  };
  if (isModalView) {
    return React.createElement(
      Modal.make,
      {
        showModal: showModal,
        setShowModal: props.setShowModal,
        children: null,
        modalHeading: modalHeading,
        modalClass:
          "w-full h-screen md:w-96 float-right overflow-hidden !bg-white dark:!bg-jp-gray-lightgray_background",
        childClass: "p-0 m-0",
        headingClass:
          headerClass +
          " py-6 px-2.5 h-24 border-b border-solid flex flex-col justify-center !bg-white dark:!bg-black border-slate-300",
        paddingClass: "",
        modalHeadingDescription: modalHeadingDescription,
        closeOnOutsideClick: closeOnOutsideClick,
        headerTextClass: headerTextClass,
        revealFrom: revealFrom,
      },
      React.createElement(
        "div",
        {
          className:
            "overflow-hidden p-6 pb-12 border-b border-solid  " +
            (showConversionRate ? "border-slate-100" : "border-slate-300") +
            " dark:border-slate-500",
          style: {
            height: showConversionRate
              ? "calc(100vh - 17rem)"
              : "calc(100vh - 12rem)",
          },
        },
        React.createElement(SelectBox.BaseSelect.make, {
          showSelectAll: showSelectAll,
          isDropDown: false,
          options: options,
          onSelect: function (arr) {
            maxLengthArray(arr, setValues);
          },
          value: LogicUtils.getJsonFromArrayOfString(values),
          showSerialNumber: showSerialNumber,
          maxHeight: "max-h-full",
          searchable: true,
          searchInputPlaceHolder:
            "Search in " + options.length.toString() + " options",
          customStyle: "px-2 py-1",
          disableSelect: disableSelect,
          isModalView: isModalView,
          customSearchStyle: "bg-white dark:bg-jp-gray-lightgray_background",
          sortingBasedOnDisabled: sortingBasedOnDisabled,
        }),
      ),
      showConversionRate
        ? React.createElement(
            "div",
            {
              className:
                "bg-[#F6F6F6] p-4 border-b border-slate-300 text-center text-[#868686]",
            },
            "Conversion rate  = " +
              Core__Option.getOr(
                options
                  .filter(function (itm) {
                    return Core__Option.getOr(values[0], "") === itm.value;
                  })
                  .map(function (item) {
                    return item.label;
                  })[0],
                "Factor 1",
              ) +
              " / " +
              Core__Option.getOr(
                options
                  .filter(function (itm) {
                    return Core__Option.getOr(values[1], "") === itm.value;
                  })
                  .map(function (item) {
                    return item.label;
                  })[0],
                "Factor 2",
              ),
          )
        : null,
      React.createElement(
        "div",
        {
          className:
            "flex flex-row items-center overflow-hidden justify-center mt-1.5 mb-1 h-20 gap-2",
        },
        showDeSelectAll && values.length > 0
          ? React.createElement(Button.make, {
              buttonState: disableSelect ? "Disabled" : "Normal",
              text: "DESELECT ALL",
              onClick: function (param) {
                setValues(function (param) {
                  return [];
                });
              },
              customButtonStyle: applyBtnStyle,
            })
          : null,
        React.createElement(Button.make, {
          buttonState: disableSelectBtn ? "Disabled" : "Normal",
          text: buttonText,
          buttonType: "Primary",
          buttonVariant: "Fit",
          onClick: onClick,
          customButtonStyle: applyBtnStyle,
        }),
      ),
    );
  } else {
    return React.createElement(SelectBox.BaseDropdown.make, {
      buttonText: "Columns",
      allowMultiSelect: true,
      input: input,
      showSelectAll: false,
      options: options,
      hideMultiSelectButtons: true,
      showBorder: false,
      hasApplyButton: true,
      onApply: onClick,
    });
  }
}

var make = SelectModal;

export { make };
/* Modal Not a pure module */
